

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Django Selenium test &mdash; PurdueCAM2Project/CAM2WebUI 1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../',
              VERSION:'1.0',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="load_latlngJSON" href="../implementationDetail/load_latlngJSON.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> PurdueCAM2Project/CAM2WebUI
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Basic Setup</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../basicSetup/git.html">Git and GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basicSetup/heroku.html">Heroku</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basicSetup/localsite.html">Viewing Website Locally</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basicSetup/selenium.html">Selenium Test Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basicSetup/sphinx.html">Sphinx-generated Github Page</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basicSetup/travis.html">Travis CI Setup</a></li>
</ul>
<p class="caption"><span class="caption-text">Implementation Details</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../implementationDetail/User.html">User</a></li>
<li class="toctree-l1"><a class="reference internal" href="../implementationDetail/GoogleFusionTable.html">Google Fusion Table</a></li>
<li class="toctree-l1"><a class="reference internal" href="../implementationDetail/CameraPopUpView.html">Camera Pop Up View</a></li>
<li class="toctree-l1"><a class="reference internal" href="../implementationDetail/Email.html">Email</a></li>
<li class="toctree-l1"><a class="reference internal" href="../implementationDetail/Admin.html">Admin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../implementationDetail/AppList.html">App List</a></li>
<li class="toctree-l1"><a class="reference internal" href="../implementationDetail/load_latlngJSON.html">load_latlngJSON</a></li>
</ul>
<p class="caption"><span class="caption-text">Test Setup</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Django Selenium test</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#running-django-test">Running Django Test</a></li>
<li class="toctree-l2"><a class="reference internal" href="#setting-up-liveserver-testcases">Setting up Liveserver testcases</a></li>
<li class="toctree-l2"><a class="reference internal" href="#setup-and-teardown">Setup and TearDown</a></li>
<li class="toctree-l2"><a class="reference internal" href="#creating-testcases">Creating testcases</a></li>
<li class="toctree-l2"><a class="reference internal" href="#webdriver-api">Webdriver API</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PurdueCAM2Project/CAM2WebUI</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Django Selenium test</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/test/test.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="django-selenium-test">
<h1>Django Selenium test<a class="headerlink" href="#django-selenium-test" title="Permalink to this headline">¶</a></h1>
<p>Selenium test environment is in the previous guide <a class="reference external" href="https://purduecam2project.github.io/CAM2WebUI/basicSetup/selenium.html">Set up selenium test environment</a>. If you haven&#8216;t done that, click on the link and finish building up selenium environment first.</p>
<div class="section" id="running-django-test">
<h2>Running Django Test<a class="headerlink" href="#running-django-test" title="Permalink to this headline">¶</a></h2>
<p>For every django app in the project, we can create a test for the app. Here in our project, visit CAM2WebUI/app folder and you can find file called tests.py. This is the file that we use to run testcase for &#8220;app&#8220; app. Go back to the main folder and run</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">test</span> <span class="n">app</span>
</pre></div>
</div>
<p>You can run several testcases which are already created for the &#8220;app&#8220; app in the tests.py file.</p>
</div>
<div class="section" id="setting-up-liveserver-testcases">
<h2>Setting up Liveserver testcases<a class="headerlink" href="#setting-up-liveserver-testcases" title="Permalink to this headline">¶</a></h2>
<p>Since we are going to create selenium test which needs to test in a live server environment, so we will use django LiveServerTestClass to create the project.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.test</span> <span class="k">import</span> <span class="n">LiveServerTestCase</span>
</pre></div>
</div>
<p>Then we create our test class with the parameter LiveServerTestCase</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">AddTestCase</span><span class="p">(</span><span class="n">LiveServerTestCase</span><span class="p">):</span>
</pre></div>
</div>
<p>Then we can create all the test cases within the addTestCase class.</p>
</div>
<div class="section" id="setup-and-teardown">
<h2>Setup and TearDown<a class="headerlink" href="#setup-and-teardown" title="Permalink to this headline">¶</a></h2>
<p>For independent testcase, we all need to set up the browser driver and the display before the test and tear down them after the test, so django test have two created superclasses for us: setUp() and tearDown().</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">display</span> <span class="o">=</span> <span class="n">Display</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1200</span><span class="p">))</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">selenium</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">()</span>
	<span class="nb">super</span><span class="p">(</span><span class="n">AddTestCase</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">setUp</span><span class="p">()</span>
</pre></div>
</div>
<p>To make the test run faster, everytime, we make the display visible=0. If there exists an error, then we can set the display visible=1.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">tearDown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">selenium</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>
	<span class="nb">super</span><span class="p">(</span><span class="n">AddTestCase</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">tearDown</span><span class="p">()</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
	<span class="k">return</span>
</pre></div>
</div>
</div>
<div class="section" id="creating-testcases">
<h2>Creating testcases<a class="headerlink" href="#creating-testcases" title="Permalink to this headline">¶</a></h2>
<p>Now we can test the app by creating all the testcases. Note that all the test function should begin with &#8220;test_&#8220; and all the testcases run in alphabetical order. So if you would like to test the function in order, create test case name wisely.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">test_one</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
	<span class="k">pass</span>
</pre></div>
</div>
<p>This is our first testcase which only uses to test if test function works.</p>
</div>
<div class="section" id="webdriver-api">
<h2>Webdriver API<a class="headerlink" href="#webdriver-api" title="Permalink to this headline">¶</a></h2>
<p>You can use webdriver API to control your browser to direct to a particular url, to find element on a page or fill in a form etc. More details of web-driver API is on the page <a class="reference external" href="http://selenium-python.readthedocs.io/api.html">Selenium Python Webdriver API</a></p>
<p>The following are some our usages of web-driver API for testing</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">test_connection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
	<span class="n">browser</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selenium</span>
	<span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">live_server_url</span>
	<span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
	<span class="k">assert</span> <span class="s1">&#39;CAM²&#39;</span> <span class="ow">in</span> <span class="n">browser</span><span class="o">.</span><span class="n">title</span>
</pre></div>
</div>
<p>In this case, we use web-driver to get the home page of the live server url. So in this testcase, we can test if the title of our homepage is CAM². If we can find our CAM² title, then that means we connect successfully to our server.</p>
<p>Note that since our django app requires basic authentication, so our URL needs to become something like: &#8220;https://username:password&#64;localhost:port/&#8220;, so in our real test cases, we need to separate our self.live_server_url to allow username and password come into the URL string.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">test_connection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
	<span class="n">browser</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selenium</span>
	<span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">live_server_url</span>
	<span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
	<span class="k">assert</span> <span class="s1">&#39;CAM²&#39;</span> <span class="ow">in</span> <span class="n">browser</span><span class="o">.</span><span class="n">title</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span>
<span class="k">def</span> <span class="nf">test_Login_Register_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
	<span class="n">browser</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selenium</span>
	<span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">live_server_url</span> <span class="o">+</span> <span class="s1">&#39;/login&#39;</span>
	<span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
	<span class="n">x</span> <span class="o">=</span> <span class="n">browser</span><span class="o">.</span><span class="n">find_element_by_name</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">)</span>  <span class="c1"># Find the search box</span>
	<span class="n">x</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s1">&#39;wrongusername&#39;</span><span class="p">)</span>
	<span class="n">y</span> <span class="o">=</span> <span class="n">browser</span><span class="o">.</span><span class="n">find_element_by_name</span><span class="p">(</span><span class="s1">&#39;password&#39;</span><span class="p">)</span>
	<span class="n">y</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s1">&#39;wrongpassword&#39;</span><span class="p">)</span>
	<span class="n">browser</span><span class="o">.</span><span class="n">find_element_by_name</span><span class="p">(</span><span class="s1">&#39;submitbutton&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
	<span class="n">error</span> <span class="o">=</span> <span class="n">browser</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="s2">&quot;loginerror&quot;</span><span class="p">)</span>
	<span class="k">assert</span> <span class="n">error</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s2">&quot;innerHTML&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;Please enter a correct username and password. Note that both fields may be case-sensitive.&#39;</span>
</pre></div>
</div>
<p>In this testcase, we first direct to the login page, and then we find the input box: username and password box and send text into the box. Then we click on the submitbutton of the browser by finding the element. Since the browser stays on the same page, we do not need to change our redirect url, we can just simply find the error mesage on the page. If we can see the error message, then that means our test cases pass!</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">test_Login_Register_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="o">....</span>

<span class="n">p</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">test_password</span><span class="p">)</span>
<span class="n">cp</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">test_password</span><span class="p">)</span>

<span class="n">browser</span><span class="o">.</span><span class="n">find_element_by_name</span><span class="p">(</span><span class="s1">&#39;registerbutton&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

<span class="c1">#test if register can work</span>

<span class="n">WebDriverWait</span><span class="p">(</span><span class="n">browser</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span>
	<span class="n">EC</span><span class="o">.</span><span class="n">text_to_be_present_in_element</span><span class="p">(</span>
	<span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span> <span class="s1">&#39;emailconfirm&#39;</span><span class="p">),</span>
	 <span class="s1">&#39;Email confirmation sent&#39;</span>
	<span class="p">)</span>
<span class="p">)</span>

<span class="o">....</span>

</pre></div>
</div>
<p>This testcase is something different from the previous ones. Since after we click on the register button, we will direct to a new url automatically and may cost some time to direct to the new url. So we are going to use the above method. We will wait the browser for 10 seconds and wait to see if there exist an element which id called &#8216;emailconfirm&#8216; on the page. If there exists an element, then the test pass. Else if the webpage cannot find the element called &#8216;emailconfirm&#8216; on the page for more than 10 seconds, then we can assume that the testcase does not pass.</p>
<hr class="docutils" />
<p>That is almost everything for our testcases. If you would like to create more testcases, you can use <a class="reference external" href="http://selenium-python.readthedocs.io/api.html">Selenium Python Webdriver API</a> as reference to test something new.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="../implementationDetail/load_latlngJSON.html" class="btn btn-neutral float-left" title="load_latlngJSON" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Purdue CAM2 Project Developers
      <span class="lastupdated">
        Last updated on Aug 19, 2019.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>